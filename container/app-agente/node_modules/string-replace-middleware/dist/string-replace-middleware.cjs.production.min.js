"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var n=e(require("hijackresponse")),t=require("stream"),r=e(require("escape-string-regexp"));function i(){return(i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var c={encoding:"utf8",ignoreCase:!0},o={contentTypeFilterRegexp:/^text\/|^application\/json$|^application\/xml$/},u=function(e,u){void 0===u&&(u={});var a=i({},o,u);return function(o,u,l){n(u,(function(n,o){var u=o.get("content-type");return a.contentTypeFilterRegexp.test(u)?n?(o.unhijack(),l(n)):(o.removeHeader("content-length"),void o.pipe(function(e,n){void 0===n&&(n={});var o=i({},c,n),u=function(e,n){return Object.keys(e).sort((function(e,n){return n.length-e.length})).map((function(t){return{matcher:new RegExp(r(t),n.ignoreCase?"gmi":"gm"),replace:e[t]}}))}(e,o),a=function(e){return Object.keys(e).reduce((function(e,n){return Math.max(e,n.length)}),0)}(e),l="";return new t.Transform({transform:function(e,n,t){var r=2*a,i=l+e.toString(o.encoding);if(i.length<3*a-2)return l=i,void t(null,"");var c=function(e,n,t){var r=e;return n.forEach((function(e){r=r.slice(0,t).replace(e.matcher,e.replace)+r.slice(t)})),[r.slice(0,t),r.slice(t)]}(i,u,r);l=c[1],t(null,c[0])},flush:function(e){l?e(null,u.reduce((function(e,n){return e.replace(n.matcher,n.replace)}),l)):e()}})}(e)).pipe(o)):o.unhijack()})),l()}};module.exports=u,module.exports.stringReplace=u,exports.stringReplace=u;
//# sourceMappingURL=string-replace-middleware.cjs.production.min.js.map
